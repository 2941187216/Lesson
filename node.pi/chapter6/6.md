## 理解Buffer

- 单宽字节字符串，都是同一个字符串

- 应用场景不同，在Node中，应用要处理网络协议、操作数据库、处理图片、接收上传文件并且还要处理网络流和文件中大量的二进制数据，JavaScript自有的字符串远不能满足需求，Buffer应运而生

## Buffer结构
Buffer是一个像Array的对象，但主要用于操作字符，

- 模块结构
Buffer是一个典型的JavaScript与C++结合的模块，性能相关部分用C++实现，非性能的部分有JavaScript实现

- Buffer对象

1:Buffer对象类似于数组，它的元素为16进制的两位数，即0到255的数值。

2:不同的编码字符串占用的元素个数各不相同。中文字符在UTF-8编码下占用3个元素，字母和半角标点符号占用1个元素

3:Buffer可以通过访问length属性得到长度，也可以通过下标访问元素和赋值，在构造对象时也和数组类似

4:给元素赋值如果小于0，就将该值逐次加256，直到得到一个0到255之间的整数。如果得到的数值大于256，就逐次减256，直到得到0到255区间的数值。如果是小数，舍弃小数部分，只保留整数部分。

- Buffer内存分配
1：Buffer对象的内存分配不是在V8的堆内存中，而是在C++层面实现内存的申请的

2：Node在内存的使用上应用的是在C++层面申请内存、在JavaScript中分配内存的策略

3：Node采用slab分配机制。slab是一种动态内存管理机制，它就是一块申请好了的固定大小的内存区域。slab有完全分配状态(full)、部分分配状态(partial)和没有被分配状态(empty)